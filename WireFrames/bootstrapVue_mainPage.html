<!DOCTYPE html>
<html>
<head>
    <title>BootstrapVue</title>

    <!-- Add Bootstrap, Bootstrap-Vue CSS, Vue,
    Babel, and Bootstrap-Vue JS to the <head> section -->
    <link type="text/css" rel="stylesheet" href="//unpkg.com/bootstrap/dist/css/bootstrap.min.css"/>
    <link type="text/css" rel="stylesheet" href="//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css"/>

    <script src="https://unpkg.com/vue@2.5.13/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.js"></script>
    <!-- Add this after vue.js -->
    <script src="//unpkg.com/babel-polyfill@latest/dist/polyfill.min.js"></script>
    <script src="//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script>
</head>
<body>
    <div id="app">
        <user-alert v-for="alert in alertData" :key=alert.id :alert-msg=alert.message></user-alert>
    </div>
    
    <script>
        // User alert component
        Vue.component('user-alert', {
            props: ['alert-msg'],
            template:
            `
            <b-alert show dismissible @dismissed="dismissAlert">
                {{ alertMsg }}
            </b-alert>
            `,
            methods: {
                // Mark an alert as read so user doesn't see it more than once
                dismissAlert: function ()
                {
                    axios
                        .put("http://127.0.0.1:8080/improvements/alerts", {
                            alertnum: 1
                        })
                        .then(response => console.log(response))
                        .catch(error => console.log(error));
                }
            }
        });

        // Main app component
        var app = new Vue({
            el: '#app',
            data: {
                alertData: null
            },
            mounted () {
                axios
                    .get("http://127.0.0.1:8080/improvements/alerts")
                    .then(response => (this.alertData = response.data))
                    .catch(error => console.log(error));
            }
        });
    </script>
</body>
</html>